<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>ç§‘ç ”ç”µå­æœ¨é±¼ - ç§¯æ”’å­¦æœ¯åŠŸå¾·</title>
    <style>
        :root {
            --bg-color: #1a1a1a;
            --text-color: #e0e0e0;
            --accent-color: #4CAF50; /* å­¦æœ¯ç»¿ */
            --wood-color: #e0e0e0;
        }

        body {
            margin: 0;
            padding: 0;
            background-color: var(--bg-color);
            color: var(--text-color);
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100vh;
            overflow: hidden;
            user-select: none;
            -webkit-user-select: none;
        }

        .container {
            text-align: center;
            position: relative;
            z-index: 10;
        }

        h1 {
            font-weight: 300;
            margin-bottom: 10px;
            opacity: 0.8;
            font-size: 24px;
        }

        .counter-container {
            margin-bottom: 40px;
        }

        .counter-label {
            font-size: 14px;
            opacity: 0.6;
            letter-spacing: 2px;
            text-transform: uppercase;
        }

        #counter {
            font-size: 48px;
            font-weight: bold;
            font-variant-numeric: tabular-nums;
            margin-top: 5px;
        }

        .muyu-container {
            cursor: pointer;
            transition: transform 0.1s;
            position: relative;
            width: 260px;
            height: 220px;
            margin: 0 auto;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .muyu-container:active, .muyu-container.active {
            transform: scale(0.95);
        }

        .muyu-svg {
            width: 100%;
            height: 100%;
            fill: var(--wood-color);
            filter: drop-shadow(0 0 10px rgba(255,255,255,0.1));
        }

        /* æµ®åŠ¨æ–‡å­—åŠ¨ç”» */
        .floating-text {
            position: absolute;
            left: 50%;
            transform: translateX(-50%);
            color: var(--text-color);
            font-weight: bold;
            font-size: 20px;
            pointer-events: none;
            white-space: nowrap;
            animation: floatUp 1s ease-out forwards;
            opacity: 0;
        }

        @keyframes floatUp {
            0% {
                top: 20%;
                opacity: 1;
                transform: translateX(-50%) scale(1);
            }
            100% {
                top: -30%;
                opacity: 0;
                transform: translateX(-50%) scale(1.2);
            }
        }

        /* åº•éƒ¨æ§åˆ¶æ  */
        .controls {
            position: fixed;
            bottom: 30px;
            display: flex;
            gap: 15px;
            z-index: 20;
        }

        .mode-btn {
            background: rgba(255,255,255,0.1);
            border: 1px solid rgba(255,255,255,0.2);
            color: var(--text-color);
            padding: 8px 16px;
            border-radius: 20px;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.3s;
        }

        .mode-btn.active {
            background: var(--accent-color);
            border-color: var(--accent-color);
            color: #fff;
            font-weight: bold;
        }

        .mode-btn:hover {
            background: rgba(255,255,255,0.2);
        }
        
        .mode-btn.active:hover {
            background: var(--accent-color);
            opacity: 0.9;
        }

        .tips {
            position: fixed;
            bottom: 10px;
            font-size: 12px;
            opacity: 0.3;
        }

        /* ç§»åŠ¨ç«¯é€‚é… */
        @media (max-width: 600px) {
            .muyu-container {
                width: 220px;
                height: 180px;
            }
            #counter {
                font-size: 40px;
            }
            .controls {
                bottom: 40px;
            }
        }
    </style>
</head>
<body>

    <div class="container">
        <h1>ç§‘ç ”ç”µå­æœ¨é±¼</h1>
        <div class="counter-container">
            <div class="counter-label" id="wish-label">å½“å‰æ„¿æœ›ï¼šå­¦æœ¯é¡ºåˆ©</div>
            <div id="counter">0</div>
        </div>

        <div class="muyu-container" id="muyu">
            <!-- åŸå§‹ SVG è·¯å¾„ä¼˜åŒ–ç‰ˆ -->
            <svg class="muyu-svg" viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg">
                <path d="M512.6 198.8c-126.8 28.5-257 266-268.4 282-48.4 67.8-87 153.6-107.2 191.4-42.6 79.8-98.4 129-106 162.8-7.6 33.6 26.8 61.2 44.4 69.6 17.6 8.4 47.2 0 58.8 0 87 8.4 273.6 98 506.4 98 0 0 376.6 5.6 405.4-269 6.8-71.4 3.6-207.2-53-213.6-47.8-6.4-76.2 3-136.8 15.4-40.2 8.2-141 22.4-159 33.6-194.8 88.6-301 152.6-330 162-22 0-41-5.4-46.4-52.2 0-19.2 73.2-65 104.6-72.4 179-42.4 263.8-55.4 273.8-55.4 14.4 0 329.6-75.8 339.2-83 9.6-7.2 19.8-14.2 19.8-39.2 0-11.4-25.2-37-54-68.2-34-37-74.6-80-105-90.2-192-127.6-301.6-151.4-397.4-140.4z" />
                <path d="M512 360c0 0-40 40-40 100s40 100 40 100" style="fill:none;stroke:var(--bg-color);stroke-width:10;opacity:0.3;"/>
            </svg>
        </div>
    </div>

    <div class="controls">
        <button class="mode-btn active" onclick="setMode('research')">ğŸ“ ç§‘ç ”å­¦æœ¯</button>
        <button class="mode-btn" onclick="setMode('health')">ğŸ’ª èº«ä½“å¥åº·</button>
        <button class="mode-btn" onclick="setMode('life')">ğŸ€ è¯¸äº‹é¡ºé‚</button>
    </div>

    <div class="tips">ç‚¹å‡»å±å¹• æˆ– æŒ‰ä¸‹ç©ºæ ¼é”® ç§¯æ”’åŠŸå¾·</div>

    <script>
        // çŠ¶æ€
        let count = 0;
        let currentMode = 'research';
        
        // è¯åº“é…ç½®
        const texts = {
            research: [
                "Paper +1", "SCI +1", "IF +10", "Bug -1", "Error -1", 
                "Accept", "Offer +1", "çµæ„Ÿ +1", "å‘é‡ +1", "Funding +1",
                "å®éªŒæˆåŠŸ", "æ•°æ®å®Œç¾", "é¡ºåˆ©æ¯•ä¸š", "ä¸€å®¡è¿‡", "é¡¶åˆŠ +1"
            ],
            health: [
                "è…°æ¤ +1", "è§†åŠ› +1", "å‘é‡ +1", "ç¡çœ  +1", "é¢ˆæ¤ +1",
                "ä½“èƒ½ +1", "å…ç–«åŠ› +1", "ç„¦è™‘ -1", "è‚åŠŸèƒ½ +1", "å¿ƒç‡æ­£å¸¸"
            ],
            life: [
                "åŠŸå¾· +1", "è´¢è¿ +1", "æ°´é€†é€€æ•£", "å¥½è¿ +1", "çƒ¦æ¼ -1",
                "å¿«ä¹ +1", "æ¡ƒèŠ± +1", "å¹³å®‰ +1", "ä¸‡äº‹èƒœæ„", "å¿ƒæƒ³äº‹æˆ"
            ]
        };

        const dom = {
            counter: document.getElementById('counter'),
            muyu: document.getElementById('muyu'),
            wishLabel: document.getElementById('wish-label'),
            btns: document.querySelectorAll('.mode-btn')
        };

        // éŸ³é¢‘ä¸Šä¸‹æ–‡
        let audioCtx;
        
        // åˆå§‹åŒ–éŸ³é¢‘ä¸Šä¸‹æ–‡ï¼ˆéœ€è¦ç”¨æˆ·äº¤äº’åæ‰èƒ½å¯åŠ¨ï¼‰
        function initAudio() {
            if (!audioCtx) {
                audioCtx = new (window.AudioContext || window.webkitAudioContext)();
            }
        }

        // åˆæˆæœ¨é±¼å£°éŸ³
        function playWoodenFishSound() {
            initAudio();
            if (audioCtx.state === 'suspended') {
                audioCtx.resume();
            }

            const t = audioCtx.currentTime;
            
            // åˆ›å»ºæŒ¯è¡å™¨
            const osc = audioCtx.createOscillator();
            const gainNode = audioCtx.createGain();
            
            // æ¨¡æ‹Ÿæœ¨é±¼çš„çŸ­ä¿ƒå£°éŸ³
            // é¢‘ç‡ä»é«˜åˆ°ä½å¿«é€Ÿæ‰«è¿‡ï¼Œæ¨¡æ‹Ÿæ•²å‡»
            osc.frequency.setValueAtTime(800, t);
            osc.frequency.exponentialRampToValueAtTime(100, t + 0.1);
            
            // éŸ³é‡åŒ…ç»œï¼šå¿«é€Ÿæ”»å‡»ï¼Œä¸­ç­‰è¡°å‡
            gainNode.gain.setValueAtTime(0, t);
            gainNode.gain.linearRampToValueAtTime(1, t + 0.01);
            gainNode.gain.exponentialRampToValueAtTime(0.01, t + 0.3);

            osc.connect(gainNode);
            gainNode.connect(audioCtx.destination);

            osc.type = 'sine';
            osc.start(t);
            osc.stop(t + 0.3);
        }

        // åˆ‡æ¢æ¨¡å¼
        window.setMode = function(mode) {
            currentMode = mode;
            // æ›´æ–°æŒ‰é’®çŠ¶æ€
            dom.btns.forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');
            
            // æ›´æ–°æ ‡ç­¾é¢œè‰²å’Œæ–‡å­—
            const root = document.documentElement;
            if (mode === 'research') {
                root.style.setProperty('--accent-color', '#4CAF50'); // ç»¿è‰²
                dom.wishLabel.textContent = "å½“å‰æ„¿æœ›ï¼šå­¦æœ¯é¡ºåˆ©";
            } else if (mode === 'health') {
                root.style.setProperty('--accent-color', '#2196F3'); // è“è‰²
                dom.wishLabel.textContent = "å½“å‰æ„¿æœ›ï¼šèº«ä½“å¥åº·";
            } else {
                root.style.setProperty('--accent-color', '#FF9800'); // æ©™è‰²
                dom.wishLabel.textContent = "å½“å‰æ„¿æœ›ï¼šè¯¸äº‹é¡ºé‚";
            }
        }

        // æ•²å‡»é€»è¾‘
        function knock() {
            // 1. å¢åŠ è®¡æ•°
            count++;
            dom.counter.innerText = count;

            // 2. æ’­æ”¾å£°éŸ³
            playWoodenFishSound();

            // 3. æœ¨é±¼åŠ¨ç”»
            dom.muyu.classList.remove('active');
            void dom.muyu.offsetWidth; // è§¦å‘é‡ç»˜
            dom.muyu.classList.add('active');
            setTimeout(() => dom.muyu.classList.remove('active'), 100);

            // 4. æ˜¾ç¤ºæµ®åŠ¨æ–‡å­—
            showFloatingText();
        }

        function showFloatingText() {
            const textPool = texts[currentMode];
            const randomText = textPool[Math.floor(Math.random() * textPool.length)];
            
            const el = document.createElement('div');
            el.className = 'floating-text';
            el.innerText = randomText;
            
            // éšæœºå¾®è°ƒä½ç½®ï¼Œæ˜¾å¾—è‡ªç„¶
            const randomX = (Math.random() - 0.5) * 40;
            el.style.transform = `translateX(calc(-50% + ${randomX}px))`;

            dom.muyu.appendChild(el);

            // åŠ¨ç”»ç»“æŸåç§»é™¤å…ƒç´ 
            setTimeout(() => {
                el.remove();
            }, 1000);
        }

        // ç»‘å®šäº‹ä»¶
        dom.muyu.addEventListener('mousedown', (e) => {
            e.preventDefault(); // é˜²æ­¢è¿ç»­ç‚¹å‡»é€‰ä¸­æ–‡æœ¬
            knock();
        });
        
        dom.muyu.addEventListener('touchstart', (e) => {
            e.preventDefault(); // é˜²æ­¢ç§»åŠ¨ç«¯å»¶è¿Ÿ
            knock();
        }, { passive: false });

        document.addEventListener('keydown', (e) => {
            if (e.code === 'Space' || e.code === 'Enter') {
                knock();
            }
        });

        // æ¢å¤ä¹‹å‰çš„è®¡æ•°ï¼ˆå¯é€‰ï¼Œæœ¬åœ°å­˜å‚¨ï¼‰
        const savedCount = localStorage.getItem('muyu_count');
        if (savedCount) {
            count = parseInt(savedCount);
            dom.counter.innerText = count;
        }

        // è‡ªåŠ¨ä¿å­˜
        setInterval(() => {
            localStorage.setItem('muyu_count', count);
        }, 5000);

    </script>
</body>
</html>
